CU_BARYTON_Reg.h
     1	#ifndef CU_BARYTON_REG_H
     2	#define CU_BARYTON_REG_H
     3	
     4	#define CTRL_uC 7
     5	#define MODE 2
     6	#define MODE_SUIVANT 3
     7	#define TIME_CCSDS_100MS 4
     8	
     9	#endif
Etape.cpp
     1	#include "Etape.hpp"
     2	
     3	int 
     4	Etape::entering() 
     5	{
     6	    if (enteringAction) {
     7	        enteringAction(); 
     8	        return 1;
     9	    } else {
    10	        return 0;
    11	    }
    12	}
    13	
    14	int 
    15	Etape::routine() 
    16	{
    17	    if (routineAction) {
    18	        routineAction();
    19	        return 1;
    20	    } else {
    21	        return 0;
    22	    }
    23	}
    24	
    25	int 
    26	Etape::leaving() 
    27	{
    28	    if (leavingAction) {
    29	        leavingAction();
    30	        return 1;
    31	    } else {
    32	        return 0;
    33	    } 
    34	}
    35	
    36	int
    37	Etape::run()
    38	{
    39	    entering();
    40	    routine();
    41	    leaving();
    42	    return 1;
    43	}
    44	
    45	void Etape::shootHK()
    46	{
    47	    write_HK(read_param(CTRL_uC), 0);
    48	    write_HK(read_param(MODE), 1);
    49	    write_HK(read_param(TIME_CCSDS_100MS), 4);
    50	}
Etape.hpp
     1	#ifndef ETAPEDEF
     2	#define ETAPEDEF
     3	
     4	#include "LibSpikCU_slave.h"
     5	#include "CU_BARYTON_Reg.h"
     6	
     7	class Etape
     8	{
     9	protected:
    10	    int etapeId;
    11	
    12	    using Action = void(*)();
    13	
    14	    Action enteringAction;
    15	    Action routineAction;
    16	    Action leavingAction;
    17	
    18	    int entering();
    19	    int routine();
    20	    int leaving();
    21	
    22	public:
    23	    Etape(int etapeId, Action entering, Action routine, Action leaving) : etapeId(etapeId), enteringAction(entering), routineAction(routine), leavingAction(leaving) {}
    24	
    25	    Etape* next;
    26	    int run();
    27	    virtual void shootHK();
    28	};
    29	
    30	#endif
files
     1	CU_BARYTON_Reg.h
     2	     1	#ifndef CU_BARYTON_REG_H
     3	     2	#define CU_BARYTON_REG_H
     4	     3	
     5	     4	#define CTRL_uC 7
     6	     5	#define MODE 2
     7	     6	#define MODE_SUIVANT 3
     8	     7	#define TIME_CCSDS_100MS 4
     9	     8	
    10	     9	#endif
    11	Etape.cpp
    12	     1	#include "Etape.hpp"
    13	     2	
    14	     3	int 
    15	     4	Etape::entering() 
    16	     5	{
    17	     6	    if (enteringAction) {
    18	     7	        enteringAction(); 
    19	     8	        return 1;
    20	     9	    } else {
    21	    10	        return 0;
    22	    11	    }
    23	    12	}
    24	    13	
    25	    14	int 
    26	    15	Etape::routine() 
    27	    16	{
    28	    17	    if (routineAction) {
    29	    18	        routineAction();
    30	    19	        return 1;
    31	    20	    } else {
    32	    21	        return 0;
    33	    22	    }
    34	    23	}
    35	    24	
    36	    25	int 
    37	    26	Etape::leaving() 
    38	    27	{
    39	    28	    if (leavingAction) {
    40	    29	        leavingAction();
    41	    30	        return 1;
    42	    31	    } else {
    43	    32	        return 0;
    44	    33	    } 
    45	    34	}
    46	    35	
    47	    36	int
    48	    37	Etape::run()
    49	    38	{
    50	    39	    entering();
    51	    40	    routine();
    52	    41	    leaving();
    53	    42	    return 1;
    54	    43	}
    55	    44	
    56	    45	void Etape::shootHK()
    57	    46	{
    58	    47	    write_HK(read_param(CTRL_uC), 0);
    59	    48	    write_HK(read_param(MODE), 1);
    60	    49	    write_HK(read_param(TIME_CCSDS_100MS), 4);
    61	    50	}
    62	Etape.hpp
    63	     1	#ifndef ETAPEDEF
    64	     2	#define ETAPEDEF
    65	     3	
    66	     4	#include "LibSpikCU_slave.h"
    67	     5	#include "CU_BARYTON_Reg.h"
    68	     6	
    69	     7	class Etape
    70	     8	{
    71	     9	protected:
    72	    10	    int etapeId;
    73	    11	
    74	    12	    using Action = void(*)();
    75	    13	
    76	    14	    Action enteringAction;
    77	    15	    Action routineAction;
    78	    16	    Action leavingAction;
    79	    17	
    80	    18	    int entering();
    81	    19	    int routine();
    82	    20	    int leaving();
    83	    21	
    84	    22	public:
    85	    23	    Etape(int etapeId, Action entering, Action routine, Action leaving) : etapeId(etapeId), enteringAction(entering), routineAction(routine), leavingAction(leaving) {}
    86	    24	
    87	    25	    Etape* next;
    88	    26	    int run();
    89	    27	    virtual void shootHK();
    90	    28	};
    91	    29	
    92	    30	#endif
    93	FluxEtape.cpp
    94	     1	#include "FluxEtape.hpp"
    95	     2	#include <cstddef>
    96	     3	
    97	     4	FluxEtape::FluxEtape() {
    98	     5	    size = 0;
    99	     6	    currentEtape = 0;
   100	     7	    isNextEtape = false;
   101	     8	
   102	     9	    root = NULL;
   103	    10	    current = NULL;
   104	    11	}
   105	    12	
   106	    13	Etape*
   107	    14	FluxEtape::operator[] (int n)
   108	    15	{
   109	    16	    Etape* it = root;
   110	    17	    for (int i = 0; it != NULL && i < n; i++)
   111	    18	        it = it->next;
   112	    19	
   113	    20	    return it;
   114	    21	}
   115	    22	
   116	    23	int  
   117	    24	FluxEtape::getEtape()
   118	    25	{
   119	    26	    return currentEtape;
   120	    27	}
   121	    28	
   122	    29	int 
   123	    30	FluxEtape::nextEtape()
   124	    31	{
   125	    32	    if (isNextEtape == false)
   126	    33	        return 0;
   127	    34	
   128	    35	    if (current->next == NULL)
   129	    36	        return -1;
   130	    37	
   131	    38	    current = current->next;
   132	    39	    currentEtape += 1;
   133	    40	
   134	    41	    return 1;
   135	    42	}
   136	    43	
   137	    44	int
   138	    45	FluxEtape::addEtape(Etape* e)
   139	    46	{
   140	    47	    if (root == NULL) {
   141	    48	        root = e;
   142	    49	        return 1;
   143	    50	    }
   144	    51	
   145	    52	    Etape* last = (*this)[size > 0 ? size - 1 : 0];
   146	    53	    last->next = e;
   147	    54	    last = last->next;
   148	    55	    size += 1;
   149	    56	    return 1;
   150	    57	}
   151	    58	
   152	    59	void
   153	    60	FluxEtape::run()
   154	    61	{
   155	    62	    while (currentEtape < size) {
   156	    63	        current->run();
   157	    64	        nextEtape();
   158	    65	    }
   159	    66	}
   160	    67	
   161	    68	void 
   162	    69	FluxEtape::removeEtape (Etape* e)
   163	    70	{
   164	    71	    // NOT NECESSARY
   165	    72	}
   166	FluxEtape.hpp
   167	     1	#ifndef FLUXETAPE
   168	     2	#define FLUXETAPE
   169	     3	
   170	     4	#include "Etape.hpp"
   171	     5	
   172	     6	class FluxEtape 
   173	     7	{
   174	     8	protected:
   175	     9	    int size;
   176	    10	    int currentEtape;
   177	    11	    bool isNextEtape;
   178	    12	    Etape* root;
   179	    13	    Etape* current;
   180	    14	
   181	    15	public:
   182	    16	    Etape* operator[] (int n);
   183	    17	    FluxEtape();
   184	    18	
   185	    19	    int getEtape();
   186	    20	    int nextEtape();
   187	    21	
   188	    22	    int addEtape (Etape*);
   189	    23	    void removeEtape (Etape*);
   190	    24	
   191	    25	    void run();
   192	    26	};
   193	    27	
   194	    28	#endif
   195	LibSpikCU_slave.h
   196	     1	#ifndef LIBSPIKCU_SLAVE_H
   197	     2	#define LIBSPIKCU_SLAVE_H
   198	     3	#include <cstdint>
   199	     4	
   200	     5	inline uint16_t HK[64] = {0};
   201	     6	inline uint16_t params[64] = {0};
   202	     7	
   203	     8	// Inline the functions
   204	     9	inline void write_HK(uint16_t value, int index) {
   205	    10	    HK[index] = value;
   206	    11	}
   207	    12	
   208	    13	inline void write_param(uint16_t value, int index) {
   209	    14	    params[index] = value;
   210	    15	}
   211	    16	
   212	    17	inline uint16_t read_param(uint8_t reg_offset) {
   213	    18	    return params[reg_offset];
   214	    19	}
   215	    20	#endif
   216	main.cpp
   217	     1	#include "mode.hpp"
   218	     2	#include <stdio.h>
   219	     3	
   220	     4	class TestMode: public Mode {
   221	     5	
   222	     6	public:
   223	     7	    TestMode(int mode) : Mode(mode) {  };
   224	     8	
   225	     9	    void 
   226	    10	    entering() override
   227	    11	    {
   228	    12	
   229	    13	    }
   230	    14	
   231	    15	    void 
   232	    16	    routine() override
   233	    17	    {
   234	    18	        flux.run();
   235	    19	    }
   236	    20	
   237	    21	    void 
   238	    22	    leaving(int nextMode) override
   239	    23	    {
   240	    24	
   241	    25	    }
   242	    26	
   243	    27	    void 
   244	    28	    shootHK() override 
   245	    29	    {
   246	    30	        Mode::shootHK();
   247	    31	    }
   248	    32	};
   249	    33	
   250	    34	int
   251	    35	main()
   252	    36	{
   253	    37	    TestMode test(0);
   254	    38	
   255	    39	    void (*enter)() = []() {
   256	    40	        printf("entering...");
   257	    41	    };
   258	    42	
   259	    43	    void (*routine)() = []() {
   260	    44	        printf("entering...");
   261	    45	    };
   262	    46	
   263	    47	    void (*leave)() = []() {
   264	    48	        printf("entering...");
   265	    49	    };
   266	    50	
   267	    51	    Etape _001(0, enter, routine, leave);
   268	    52	
   269	    53	    test.flux.addEtape(&_001);
   270	    54	
   271	    55	    test.entering();
   272	    56	    test.routine();
   273	    57	}
   274	mode.cpp
   275	     1	#include "mode.hpp"
   276	     2	
   277	     3	void Mode::entering()
   278	     4	{
   279	     5	    // write_param(MODE, this->modeId);
   280	     6	}
   281	     7	
   282	     8	void Mode::leaving(int nextMode)
   283	     9	{
   284	    10	    write_param(MODE, nextMode);
   285	    11	}
   286	    12	
   287	    13	void Mode::routine()
   288	    14	{
   289	    15	    // Do nothing
   290	    16	}
   291	    17	
   292	    18	void Mode::shootHK()
   293	    19	{
   294	    20	    write_HK(read_param(CTRL_uC), 0);
   295	    21	    write_HK(read_param(MODE), 1);
   296	    22	    write_HK(read_param(TIME_CCSDS_100MS), 4);
   297	    23	}
   298	    24	
   299	    25	ModeStateManager::ModeStateManager(Mode **modes, int modeCount)
   300	    26	{
   301	    27	    this->modes = modes;
   302	    28	    this->modeCount = modeCount;
   303	    29	    this->currentMode = 0;
   304	    30	}
   305	    31	
   306	    32	void ModeStateManager::run()
   307	    33	{
   308	    34	    while (1)
   309	    35	    {
   310	    36	        write_param(MODE, currentMode);
   311	    37	        modes[currentMode]->entering();
   312	    38	        while (!hasModeChanged())
   313	    39	        {
   314	    40	            modes[currentMode]->routine();
   315	    41	        }
   316	    42	        modes[currentMode]->leaving(nextMode);
   317	    43	        currentMode = nextMode;
   318	    44	    }
   319	    45	}
   320	    46	
   321	    47	/**
   322	    48	 * @brief Check if the mode has changed
   323	    49	 * @return true if the mode has changed
   324	    50	 */
   325	    51	bool ModeStateManager::hasModeChanged()
   326	    52	{
   327	    53	    // Two Possible ways of changing mode either by reading the
   328	    54	    // nextMode from the OBC or by checking the currentMode
   329	    55	
   330	    56	    // The Payload has changed the mode (i.e END or ERROR )
   331	    57	    if (nextMode != currentMode)
   332	    58	    {
   333	    59	        write_param(MODE_SUIVANT, nextMode);
   334	    60	        return true;
   335	    61	    }
   336	    62	    // Check if the OBC has changed the mode
   337	    63	    nextMode = read_param(MODE_SUIVANT);
   338	    64	    return nextMode != currentMode;
   339	    65	}
   340	    66	
   341	    67	void ModeStateManager::shootHK()
   342	    68	{
   343	    69	    modes[currentMode]->shootHK();
   344	    70	}
   345	mode.hpp
   346	     1	#ifndef MODEDEF
   347	     2	#define MODEDEF
   348	     3	
   349	     4	#include "FluxEtape.hpp"
   350	     5	
   351	     6	class Mode
   352	     7	{
   353	     8	protected:
   354	     9	    int modeId;
   355	    10	
   356	    11	public:
   357	    12	    Mode(int modeId) : modeId(modeId) {}
   358	    13	    FluxEtape flux;
   359	    14	    virtual void entering();
   360	    15	    virtual void routine();
   361	    16	    virtual void leaving(int nextMode);
   362	    17	    virtual void shootHK();
   363	    18	};
   364	    19	
   365	    20	class ModeStateManager
   366	    21	{
   367	    22	private:
   368	    23	    Mode **modes;
   369	    24	    int currentMode = 0;
   370	    25	    int modeCount;
   371	    26	    int nextMode;
   372	    27	
   373	    28	public:
   374	    29	    ModeStateManager(Mode **modes, int modeCount);
   375	    30	    void run();
   376	    31	    bool hasModeChanged();
   377	    32	    void shootHK();
   378	    33	};
   379	    34	;
   380	    35	
   381	    36	#endif
   382	output
   383	     1	ELF         >    P      @       Ğz          @ 8  @ & %       @       @       @                                ´      ´      ´                                                         8	      8	                                        É	      É	                                           ˆ      ˆ                   ğ,      ğ<      ğ<      0      P                   °-      °=      °=                               P      P      P      @       @                                      $       $                    h&      h&      h&                             Såtd   P      P      P      @       @              Påtd   (       (       (       D      D             Qåtd                                                  Råtd   ğ,      ğ<      ğ<                            0      GNU € À           À           À                   GNU lÊšì;PSg~Ó<äX1]Ên_¶/lib64/ld-linux-x86-64.so.2                                                      Ç                      ¸   "                   F                      ¦                      •                      l                                                                    ,                        __gmon_start__ _ITM_deregisterTMCloneTable _ITM_registerTMCloneTable _ZTVN10__cxxabiv117__class_type_infoE _ZTVN10__cxxabiv120__si_class_type_infoE __stack_chk_fail __libc_start_main __cxa_finalize printf libstdc++.so.6 libm.so.6 libgcc_s.so.1 libc.so.6 CXXABI_1.3 GLIBC_2.4 GLIBC_2.34 GLIBC_2.2.5               Î          Ó¯k   ÿ         õ          ii   
   384	     2	     ´‘–        ui	         ğ<             @      ø<             ğ      =             x=      =                    =             ˆ=      (=             ¢      0=             ®      8=             Î      @=             Ü      P=              =      X=             ø      `=             &      h=                   p=             2      €=                    =                    ˜=              =      ¨=             "       @             @      x=                    =                   ˆ=                   À?                    È?                    Ğ?                    Ø?                    à?         	            @                    @                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            óúHƒìH‹É/  H…ÀtÿĞHƒÄÃ     ÿ5Ê/  ÿ%Ì/  @ ÿ%Ê/  h    éàÿÿÿÿ%Â/  h   éĞÿÿÿóú1íI‰Ñ^H‰âHƒäğPTE1À1ÉH=´  ÿS/  ôf.„     H=™/  H’/  H9øtH‹6/  H…Àt	ÿà€    Ã€    H=i/  H5b/  H)şH‰ğHÁî?HÁøHÆHÑştH‹/  H…ÀtÿàfD  Ã€    óú€=%/   u3UHƒ=º.   H‰åtH‹=/  ÿ¨.  ècÿÿÿÆü.  ]Ãf.„     Ãff.„     @ óúégÿÿÿUH‰åHƒìH‰}øH‹EøH‹@H…ÀtH‹EøH‹@ÿĞ¸   ë¸    ÉÃUH‰åHƒìH‰}øH‹EøH‹@H…ÀtH‹EøH‹@ÿĞ¸   ë¸    ÉÃUH‰åHƒìH‰}øH‹EøH‹@ H…ÀtH‹EøH‹@ ÿĞ¸   ë¸    ÉÃUH‰åHƒìH‰}øH‹EøH‰ÇèRÿÿÿH‹EøH‰ÇèxÿÿÿH‹EøH‰Çèÿÿÿ¸   ÉÃUH‰åHƒìH‰}ø¿   èl   ·À¾    ‰Çè5   ¿   èS   ·À¾   ‰Çè   ¿   è:   ·À¾   ‰Çè   ÉÃUH‰å‰ø‰uøf‰Eü‹EøH˜H H±-  ·Eüf‰]ÃUH‰å‰øˆEü¶EüH˜H H.  ·]ÃUH‰åH‰}øH‹EøÇ     H‹EøÇ@    H‹EøÆ@ H‹EøHÇ@    H‹EøHÇ@    ]ÃUH‰åH‰}è‰uäH‹EèH‹@H‰EøÇEô    ëH‹EøH‹@(H‰EøƒEôHƒ}ø t‹Eô;Eä|áH‹Eø]ÃUH‰åH‰}øH‹Eø‹@]ÃUH‰åH‰}øH‹Eø¶@¶À…Àu¸    ëBH‹EøH‹@H‹@(H…Àu¸ÿÿÿÿë*H‹EøH‹@H‹P(H‹EøH‰PH‹Eø‹@PH‹Eø‰P¸   ]ÃUH‰åHƒì H‰}èH‰uàH‹EèH‹@H…ÀuH‹EèH‹UàH‰P¸   ëQH‹Eè‹ º   …ÀNÂPÿH‹Eè‰ÖH‰ÇèõşÿÿH‰EøH‹EøH‹UàH‰P(H‹EøH‹@(H‰EøH‹Eè‹ PH‹Eè‰¸   ÉÃUH‰åHƒìH‰}øëH‹EøH‹@H‰ÇèŠıÿÿH‹EøH‰ÇèğşÿÿH‹Eø‹PH‹Eø‹ 9Â|ÓÉÃUH‰åH‰}øH‰uğ]ÃUH‰åHƒìH‰}øHp  H‰Ç¸    èˆûÿÿÉÃUH‰å¿    èÏÿÿÿ]ÃUH‰åHƒìH‰}øH<  H‰Ç¸    èTûÿÿÉÃUH‰å¿    èÏÿÿÿ]ÃUH‰åHƒìH‰}øH  H‰Ç¸    è ûÿÿÉÃUH‰å¿    èÏÿÿÿ]ÃUH‰åHì   dH‹%(   H‰Eø1ÀHE¾    H‰Çè"  HVÿÿÿH‰…xÿÿÿH|ÿÿÿH‰E€H¥ÿÿÿH‰EˆH‹uˆH‹M€H‹•xÿÿÿHEÀI‰ğ¾    H‰ÇèK   HEÀHUHƒÂH‰ÆH‰×èşÿÿHEH‰Çèê   HEH‰Çèê   ¸    H‹UødH+%(   tècúÿÿÉÃUH‰åH‰}ø‰uôH‰UèH‰MàL‰EØH'  H‹EøH‰H‹Eø‹Uô‰PH‹EøH‹UèH‰PH‹EøH‹UàH‰PH‹EøH‹UØH‰P ]ÃUH‰åHƒìH‰}ø‰uôH'  H‹EøH‰H‹Eø‹Uô‰PH‹EøHƒÀH‰ÇèMüÿÿÉÃUH‰åHƒìH‰}ø‰uôH‹Eø‹Uô‰ÖH‰Çè¦ÿÿÿH‘&  H‹EøH‰ÉÃUH‰åH‰}ø]ÃUH‰åHƒìH‰}øH‹EøHƒÀH‰ÇènıÿÿÉÃUH‰åH‰}ø‰uô]ÃUH‰åHƒìH‰}øH‹EøH‰Çè>   ÉÃUH‰åH‰}ø]ÃUH‰åHƒìH‰}ø‰uô‹Eô‰Æ¿   èr  ÉÃUH‰åH‰}ø]ÃUH‰åHƒìH‰}ø¿   èRûÿÿ·À¾    ‰Çèûÿÿ¿   è9ûÿÿ·À¾   ‰Çèûÿÿ¿   è ûÿÿ·À¾   ‰ÇèéúÿÿÉÃUH‰åH‰}øH‰uğ‰UìH‹EøÇ@    H‹EøH‹UğH‰H‹Eø‹Uì‰PH‹EøÇ@    ]ÃUH‰åHƒìH‰}øH‹Eø‹@‰Æ¿   è«  H‹EøH‹H‹Eø‹@H˜HÁàHĞH‹ H‹ H‹H‹EøH‹H‹Eø‹@H˜HÁàHÈH‹ H‰ÇÿÒëCH‹EøH‹H‹Eø‹@H˜HÁàHĞH‹ H‹ HƒÀH‹H‹EøH‹H‹Eø‹@H˜HÁàHÈH‹ H‰ÇÿÒH‹EøH‰Çèg   ƒğ„ÀuªH‹EøH‹H‹Eø‹@H˜HÁàHĞH‹ H‹ HƒÀH‹H‹EøH‹H‹Eø‹@H˜HÁàHĞH‹ H‹Uø‹R‰ÖH‰ÇÿÑH‹Eø‹PH‹Eø‰Pé÷şÿÿUH‰åHƒìH‰}øH‹Eø‹PH‹Eø‹@9ÂtH‹Eø‹@‰Æ¿   èƒ   ¸   ë'¿   èxùÿÿ·ĞH‹Eø‰PH‹Eø‹PH‹Eø‹@9Â•ÀÉÃUH‰åHƒìH‰}øH‹EøH‹H‹Eø‹@H˜HÁàHĞH‹ H‹ HƒÀH‹H‹EøH‹H‹Eø‹@H˜HÁàHÈH‹ H‰ÇÿÒÉÃUH‰å‰ø‰uøf‰Eü‹EøH˜H H'  ·Eüf‰]ÃóúHƒìHƒÄÃ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         5Etape entering...  8TestMode 4Mode ;D  '   øïÿÿx  (ğÿÿ`  "ñÿÿà  Tñÿÿ   †ñÿÿ   ¸ñÿÿ@  ğñÿÿ`  Jòÿÿ   ròÿÿÀ  ’òÿÿ€  Òòÿÿ   óÿÿÀ  *óÿÿà  Œóÿÿ   ôÿÿ   Pôÿÿ@  `ôÿÿ@  ƒôÿÿ`  ”ôÿÿ€  ·ôÿÿ   ÈôÿÿÀ  ëôÿÿà  ûôÿÿ   ¸õÿÿ`  öÿÿ€  Höÿÿ   zöÿÿÀ  †öÿÿà  ¦öÿÿ   ´öÿÿ   Ğöÿÿ@  Üöÿÿ`  şöÿÿ€  
   385	     3	÷ÿÿ   d÷ÿÿÀ  ¢÷ÿÿà  ¸øÿÿü  ùÿÿ  lùÿÿ              zR x        Àîÿÿ&    D    $   4   xîÿÿ0    FJw€ ?;*3$"       \   ¢ğÿÿ(    A†Cc      |   ªğÿÿ     A†C[      œ   :ïÿÿ1    A†Cl      ¼   Lïÿÿ1    A†Cl      Ü   ^ïÿÿ1    A†Cl      ü   pïÿÿ7    A†Cr        ˆïÿÿZ    A†CU     <  
   386	     4	ğÿÿ@    A†C{      \  *ğÿÿE    A†C@     |  Pğÿÿ    A†CL      œ  Bğÿÿb    A†C]     ¼  „ğÿÿƒ    A†C~     Ü  èğÿÿ?    A†Cz      ü  ñÿÿ    A†CJ        PòÿÿV    A†CQ     <  †òÿÿ:    A†Cu      \   òÿÿ1    A†Cl      |  ²òÿÿ    A†CF      œ  òÿÿ    A†CZ      ¼  òÿÿ    A†CI      Ü  Œòÿÿ    A†CV      ü  ğÿÿ#    A†C^        ğÿÿ    A†CK      <  ğÿÿ#    A†C^      \  ğÿÿ    A†CK      |   ğÿÿ#    A†C^      œ  ğÿÿ    A†CK      ¼  óïÿÿ¼    A†C·     Ü  Dôÿÿ(    A†Cc      ü  ˆñÿÿ    A†CF        tñÿÿ!    A†C\      <  vñÿÿ    A†CF      \  bñÿÿZ    A†CU     |  œñÿÿ=    A†Cx      œ  ºñÿÿ   A†C      ¸  ´òÿÿa    A†C\     Ø  öòÿÿR    A†CM               GNU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       @      ğ              x=                    ˆ=      ¢      ®      Î      Ü               =      ø      &            2                                     =              "              Î              İ              ç              õ                            ¼             ğ<                           ø<                    õşÿo    Ğ             à             ğ      
   387	     5	       +                                          è?             0                            	             €             ˆ      	              ûÿÿo           şÿÿo           ÿÿÿo           ğÿÿo          ùÿÿo                                                                                                                                   °=                      6      F              @      GCC: (GNU) 14.2.1 20250207 L             J      (      r      (       š                              ,    '       º      Í                      œ    ş       ˆ      W      à      V       6      :       p      1       ¢             ®             Î             Ü                             \    Ú       ø      œ      r      (       ”      (       š                              #         !ş                      \  –  ğ  ë  ©  %R   ^  +  &*   u  'q      {   (1   k  )   int p   *8   !  ,¯        -?       4F   Ú   5Y   [  6e   Ê  7x   Æ  8„   ¥  9—   Â   :£   K  ;¶   ‚  H¯   '   I?   e  «  F   w  e   m  „   #  £   -  Y   }   x   r   —     ¶      Â   ]  Ú   È  ò   Ä   
   388	     6	  Ü   Î   Ì   æ   §  !ş   M  "  k  /R   å  1¯   ×  2¯   ‡   3¯   j  <*   ä  >?   Ö  ??   †   @?   £   L¯   ¢   O?   „  Z"  )   [.  std 
   389	     7	4G  3A  4M  5Y  6e  8  9  :  ;%  =¡  >­  ?¹  @Å  By  Ca  Eq  F}  G‰  H•  J1  K=  LI  MU  OÑ  Pİ  Qé  Rõ  T…  Um   }  W  ?   ? HK G  	@@      D  G  	À@      ¸  0	„  °  ²  »   º   
   390	     8		   ³   	Ê  5  ­  ¬   ­  b   ­   	  ê      ÷  ı  Ğ   	Ò   ÷         Ğ   	¾  ¶     /  5  Ğ   ¸  	ÿ   J  d  Ğ     ­  ­  ­   Û  Ğ  (run %G      Š    Ğ   š   -3    „  ©  Ğ       »   
   391	     9	À    °  
   392	    10	Ï  
   393	    11	„  Ğ    ù        Z       œ  ò  Õ  ‘h q  %  à      7       œ2  ò  Õ  ‘h   Q  ®      1       œ^  ò  Õ  ‘h ı  }  |      1       œŠ  ò  Õ  ‘h á  ©  J      1       œ¶  ò  Õ  ‘h W     }  š              œë  w  $q  ‘l   	   r      (       œ”   	}  ‘lŸ  	*   ‘h  Ó   ğ    !ú       º      Í      *  \  –  ğ  ë  ©  %V   ^  +  &.   u  'u      {   (5   k  )”   int p   *<   !  ,³        -C       4J   Ú   5]   [  6i   Ê  7|   Æ  8ˆ   ¥  9›   Â   :§   K  ;º   ‚  H³   '   IC   e  «  J   w  i   m  ˆ   #  §   -  ]   }   |   r   ›     º      Æ   ]  Ş   È  ö   Ä     Ü   Ò   Ì   ê   §  !  M  "  k  /V   å  1³   ×  2³   ‡   3³   j  <.   ä  >C   Ö  ?C   †   @C   £   L³   ¢   OC   „  Z&  )   [2  std 4n  3E  4Q  5]  6i  8  9  :  ;)  =¥  >±  ?½  @É  B}  Ce  Eu  F  G  H™  J5  KA  LM  MY  OÕ  Pá  Qí  Rù  T‰  Uq  =ù   %   	„  8  		”      
   394	    12		”   F  
   395	    13	„  ƒ  °  ı  °    à  °  Î  Ù  µ  	”    %  v  ì  ò  µ   »  	ò  ”   	    µ   Ä  	=  ”   &  ,  µ   R  	W  ”   C  N  µ  	°   Î  
   396	    14	`  a  l  µ  	°   run 	
   397	    15	  }  µ    ˆ  ¸  °  run 	G   ”   ©  °    ‹  n  µ   
   398	    16	©  ë  .  ªë     «ò   ›  Ú    
   399	    17	´¿  N  E'  x             œ@  ò  º  ‘h
   400	    18	e E °  ‘` l  <`  8      ?       œm  ò  º  ‘h ,  -  ´      ƒ       œµ  ò  º  ‘X
   401	    19	e -°  ‘P[  4°  ‘h   Õ  R      b       œâ  ò  º  ‘h ò    @             œ  ò  º  ‘h ·  /  ú      E       œs  ò  º  ‘X
   402	    20	n ”   ‘Tit °  ‘h      (       i ”   ‘d  Ù  „     ò  º   s  ©  ±  º      @       œº  „  ‘h   =  /  æ   Ø
   403	    21	   ø    !W      8           n  \  –  ğ  ë  ©  %R   ^  +  &*   u  'q      {   (1   k  )   int p   *8   !  ,¯        -?       4F   Ú   5Y   [  6e   Ê  7x   Æ  8„   ¥  9—   Â   :£   K  ;¶   ‚  H¯   '   I?   e  :  «  F   w  e   m  „   #  £   -  Y   }   x   r   —     ¶      Â   ]  Ú   È  ò   Ä   
   404	    22	  Ü   Î   Ì   æ   §  !ş   M  "  k  /R   å  1¯   ×  2¯   ‡   3¯   j  <*   ä  >?   Ö  ??   †   @?   £   L¯   ¢   O?   „  Z"  )   [.  std 4L  3F  4R  5^  6j  8  9  :  ;*  =¦  >²  ?¾  @Ê  B~  Cf  Ev  F‚  G  Hš  J6  KB  LN  MZ  OÖ  Pâ  Qî  Rú  TŠ  Ur   %   
   405	    23	f  8  		      
   406	    24		   F  
   407	    25	f  ƒ  Ó  ı  Ó    à  Ó  ¬  ·  İ      %  
   408	    26	v  Í   Ó  İ   »  	ò     ê  ğ  İ   Ä  	=         İ   R  	W     $  /  İ  Ó   Î  
   409	    27	
   410	    28	`  C  N  İ  Ó    run 
   411	    29	
   412	    30	  _  İ    ˆ  ¸  Ó  	š   3    m  ‘  —  Ó   ¸  ÿ   «  Å  Ó     Å  Å  Å   !³   Ú   m  Ó  L  İ  M  –  	¾    ç      –      	Ò   Õ  ç  1  7  –   	  u   ç  R  X  –   	š   I  ç  s  y  –   "M  +  Š  –       ç  –  A  #  0ç  ¸  $ç     %  Î  Ù  ½        ô  ê  õ  ½  Ç            ½  Í     8  %  0  ½      	  
   413	    31	»   ¥  K  Q  ½   	Ò   ™  ¥  l  r  ½   	¾    ¥    ˜  ½      %š   ¹  ¥  ±  ½    ¥  ¥  ½  &¥  '¸  (·  â  ä  î  ò  â   )ˆ  k        * +´  #   #      ¼       œÙ  İ  %¥  ‘€o  'Ú  ‘è~'½  Ó  Z  j  _  F      °  ˜  ˆ      #       œ¥  “  ‰  F  
   414	    32	\    ‘h Ğ  «             œ Ò   +Ú  ‘ğ~+C  Ó  à  ğ  å  Ì      °    ¼      #       œ+      Ì  
   415	    33	\    ‘h Ğ  ß             œ ‰  /Ú  ‘ø~/É  Ó  f  v  k  R      °  ¤  ğ      #       œ±  Ÿ  •  R  
   416	    34	\  š  ‘h Ğ               œ è  3m  ‘° ,Ù  ˜  ş  Ü             œ	  
   417	    35	ò  Â  ‘h r  *	  Î             œF	  
   418	    36	ò  Â  ‘h-f     ‘d Q  e	  ®             œr	  
   419	    37	ò  Â  ‘h 0  ‘	  ¢             œ	  
   420	    38	ò  Â  ‘h   «	  Á	  ò  Â  í      	    ä	  p      1       œõ	  «	  ‘h´	  ‘d y  
   421	    39	  
   422	    40	  ò  ›        õ	    ;
   423	    41	  6      :       œL
   424	    42	  
   425	    43	  ‘h
   426	    44	  ‘d —  Y
   427	    45	  “
   428	    46	  ò  Ø  º        Å  Ò   0Å  ¾  @Å   .L
   429	    47	  ò  ²
   430	    48	  à      V       œY
   431	    49	  ‘hb
   432	    50	  ‘dn
   433	    51	  ‘Xz
   434	    52	  ‘P†
   435	    53	  ‘H  Ş   ò    !q      –           +  \  –  ğ  ë  ©  %R   ^  +  &*   u  'q      {   (1   k  )   int p   *8   !  ,¯        -?       4F   Ú   5Y   [  6e   Ê  7x   Æ  8„   ¥  9—   Â   :£   K  ;¶   ‚  H¯   '   I?   e  «  F   w  e   m  „   #  £   -  Y   }   x   r   —     ¶      Â   ]  Ú   È  ò   Ä   
   436	    54	  Ü   Î   Ì   æ   §  !ş   M  "  k  /R   å  1¯   ×  2¯   ‡   3¯   j  <*   ä  >?   Ö  ??   †   @?   £   L¯   ¢   O?   „  Z"  )   [.  std 4G  3A  4M  5Y  6e  8  9  :  ;%  =¡  >­  ?¹  @Å  By  Ca  Eq  F}  G‰  H•  J1  K=  LI  MU  OÑ  Pİ  Qé  Rõ  T…  Um   }  W  ?   ? HK G  	@@      D  G  	À@      %   	©  8  			      	
   437	    55		   F  	
   438	    56	©  ƒ  	µ  ı  	µ  
   439	    57	  	à  µ  î  ù  º      %  	v      º   
   440	    58	»  		ò     +  1  º   
   441	    59	Ä  		=     I  O  º   
   442	    60	R  		W     g  r  º  µ   Î  	
   443	    61	`  †  ‘  º  µ   run 	
   444	    62	  ¢  º    ˆ  ¸  °  „  6  
   445	    63	p  $  I   i  	   u  	   f  	   6  
   446	    64	      X  I      run 
   447	    65	
   448	    66	*  4  :  X   
   449	    67	í  
   450	    68	
   451	    69	ü  ©  R  X  X   š   
   452	    70	 
   453	    71	Í  i  X     M  0
   454	    72	p  I  !G  m     
   455	    73			   M  
   456	    74	+  ®  ¹  N      R  
   457	    75	„    u   p  à  æ  N   Ò   Õ  p  ÿ    N   ¾    p    )  N      "š   I  p  B  N    N  p  N  ¿  X  #   m  $ r  %  b  X  Cœ  B      R       œ©  ò  ]  ‘h :  3É  à      a       œÖ  ò  ]  ‘h    ö  Ê            œ  ò  ]  ‘h &û     2  'ò  ]  $  +I  u  6    (     U  Œ      =       œn    ‘h  ‘`'  ‘\ )    2      Z       œš  ò  S  ‘h æ  ¹  &             œÆ  ò  S  ‘h   å        !       œ  ò  S  ‘h	f     ‘d Ç     ø             œ-  ò  S  ‘h )W     }  š              œc  	w  $q  ‘l *Á  W  ”      (       œ¤  	”   "}  ‘l	Ÿ  -   ‘h +  	   r      (       œ	”   	}  ‘l	Ÿ  	*   ‘h   :;9I   :!;9!  $ >   I4   :!	;9I82  .Gd@|   I4   I  	.?:!;9!nI2!<d  
   458	    76	 !I   :!;9I  %U  $ >  9:;9  I  ! I/  4 :;9I?   4 :;9I?   :;9   I842   :;9I2  .?:;9n2<d  .?:;9nI2<d  .?:;9nLM2<d  I      I     & I  .?:;9nI@z  .?:;9n@z    :;9I   :;9!  $ >   I4   I4   :!	;9I82!  .?:!	;9nI2!<d  .G:!;9!d@z  	 I  
   459	    77	 :!;9I  .?:!	;9n2!<d   !I   :!
   460	    78	;9Iˆ8  .G:!;9!d@|  4 :!;9I  %  $ >  9:;9  :;9  .?:;9n2<d  <  .?:;9nI2<d  & I  ˆ:;9n   :;9Iˆ  4 :;9I    .G:;9d    I4  .1nd@z   1    :;9I   I4   :!	;9!   I  & I   !I  $ >   1  	.?:;9nL!M2!<d  
   461	    79	 I4   :;9I   :!
   462	    80	;9I82!  4 :!;9I  .?:!
   463	    81	;9nI2!<d   I4  .?:;9n2!<d  .?n42!<d  !:!;9  .4<d  .4d@|  . 4@|  .Gd !  <  .Gd@|  .Gd@z  .1nd@|  %U  $ >  9:;9  :;9  .?:;9n2<d    .?:;9n2<d  ! :;9I2  ".?:;9n2<d  #:;9  $ I82  %.?:;9nLM2<d  &B I  ' I  (.1nd  ).?:;9I<  *   +.?:;9I@|  ,   - :;9I  ..1nd@z    :;9I   :!;9!   I4  $ >   :;9I82   I   I4   !I  	 :;9I  
   464	    82	.?:;9nI2!<d  .?:;9n2!<d   :!
   465	    83	;9I8  .?:!;9!nL!M2!<d  .G:!;9!d@|   1  :;9!  & I   :!;!9I  .Gd@|  .Gd@z  %U  $ >  9:;9  I  ! I/  4 :;9I?   4 :;9I?   .?:;9n2<d   <  .?:;9n2<d  .?:;9n2<d   :;9  ! I842  ".?:;9nLM2<d  #I  $   % I  &.G:;9d   ' I4  (.1nd@z  ).?:;9nI@z  *.?:;9n@z  +.?:;9n@z   &    g   û          /   A   N   f   ş    —    ş    ©   ±   ¿   Î   İ   æ   D   î   1 	r      Éu 0 	š      ‘J  	J      	»‚	Y‚/vZ@	»‚	Y‚/vZ@	»‚	Y‚/vZ@»»»»Y?» å å å @    u   û          /   A   N     f   ú    ú    ©   ±   ¿   Î   İ   æ   8  @   N  î   D    	º      
   466	    84	ƒŸ­
   467	    85	„»»@­»t/ ¹  J t…K@ƒu@	ƒ¬K	v‚JYv‚Jƒt Y2	ó‚Y»w$f2K
   468	    86	»»
   469	    87	f‘Y@»	/‚ƒ¸tfN\¼ ¹    q   û          /   A   N   f   W   D   `   W   ©   ±   ¿   Î   İ   æ   @   î   i   	à      ¤fKÖ]wºº§º  	6      %äÖ%(ò  	p      #ä (Ö  	¢      	…  	®      ¼ó  	Î      ¯  	Ü      ¼»  	ˆ      &»=:LÊ»=:LÊ»=:Lsº¬åÚ°(°#h»» Ë    l   û          /   A   N   f   q   —    q   ©   ±   ¿   Î   İ   æ   @   `   î   1 	r      Éu 4 	”      Éu 0 	š      ‘J  	ø      „MååM„M» å å å>?ä®­Ÿ­M½	/t%t	t%t	ƒ0t(tÈt(t€ º	xt$t	Èt$ttytf	¿ttL/w  <ut»?»t tÈt tƒ __int_least8_t _Z8write_HKti short int __uintmax_t _ZN5Etape7shootHKEv _ZN5Etape3runEv read_param leavingAction __uint32_t __uint16_t uint_fast64_t value shootHK uintptr_t routineAction etapeId __int_least64_t routine __uint_least8_t _ZN5Etape8enteringEv _ZN5EtapeC4EiPFvvES1_S1_ entering __int64_t __uint8_t enteringAction params __uint_least64_t unsigned char uint_fast8_t reg_offset __intmax_t write_HK short unsigned int __int8_t _vptr.Etape leaving __int_least32_t uint_fast32_t uint_fast16_t this _ZN5Etape7routineEv __uint64_t GNU C++17 14.2.1 20250207 -mtune=generic -march=x86-64 -g -std=c++17 __int_least16_t __int32_t __int16_t _Z10read_paramh __vtbl_ptr_type index __uint_least32_t _ZN5Etape7leavingEv __uint_least16_t next _ZN9FluxEtapeixEi _ZN9FluxEtape8getEtapeEv _ZN9FluxEtape3runEv __max_align_ld __max_align_ll _ZN9FluxEtape9nextEtapeEv _ZN9FluxEtape8addEtapeEP5Etape _ZN9FluxEtapeC4Ev bool 11max_align_t long long int _ZN9FluxEtapeC2Ev getEtape nextEtape removeEtape long double long long unsigned int current operator[] wchar_t currentEtape FluxEtape char32_t size char16_t isNextEtape addEtape last _ZN9FluxEtape11removeEtapeEP5Etape root printf ~TestMode _ZN8TestMode7routineEv operator() _ZN8TestMode8enteringEv ~<lambda> test _ZN9FluxEtapeC1Ev _ZN8TestModeC4EOS_ _ZN8TestMode7leavingEi _ZN4ModeC2Ei _ZN4ModeC4Ei _ZN8TestModeC4Ei _ZN4Mode7shootHKEv __closure nextMode enter _ZN4Mode8enteringEv leave _ZN8TestModeC2Ei _ZN8TestModeC4ERKS_ main _ZN8TestMode7shootHKEv _FUN _ZN4Mode7routineEv _001 mode _ZN5EtapeC2EiPFvvES1_S1_ _ZN4Mode7leavingEi modeId _ZN8TestModeD4Ev ModeStateManager _vptr.Mode flux _Z11write_paramti currentMode modeCount _ZN16ModeStateManagerC4EPP4Modei _ZN16ModeStateManagerC2EPP4Modei write_param _ZN16ModeStateManager7shootHKEv hasModeChanged _ZN16ModeStateManager14hasModeChangedEv modes _ZN16ModeStateManager3runEv /home/daerean/Codes/estia/nanosat/tests/etapes /usr/include/bits /usr/include /usr/include/c++/14.2.1 /usr/include/c++/14.2.1/x86_64-pc-linux-gnu/bits LibSpikCU_slave.h types.h stdint-intn.h stdint-uintn.h stdint-least.h stdint.h cstdint c++config.h FluxEtape.cpp /usr/lib/gcc/x86_64-pc-linux-gnu/14.2.1/include cstddef FluxEtape.hpp stddef.h main.cpp mode.hpp stdio.h mode.cpp (         J      ¨r      (š        Z         ˆ      ×à      V6      :p      1¢      ®      Î      Ü       2         ø      œr      (”      (š                                        ñÿ                    ñÿ                    ñÿ                     ˆ      #       -     «             D     ¼      #       Z     ß             r     ğ      #       ˆ                       ñÿ                     ñÿ                ©      (               ¼     °=              Å     è?              Û   !   =             å                      ø     J      1           º      @           B      R       ?     @              F    ´      ƒ       p     @              e                   t    Œ      =       •    à      a       ½  !  =      0       Ë  "  à      V       ä  "                   ÿ    ®      1           #      ¼                 !       +    à      7       ;   @              H    |      1       \  "  6      :       i                     š   ¼                                    ½  "  š              Í    ú      E       ß    ø             ó    Ê              !  H=      0         !  ˆ=             '    8      ?       t    P      &       ;    @             T    R      b       n    Œ      =         "  ®             ¦    2      Z       ¹  "  ¢             Ñ                     ì                  ò  "  ”      (         !   =                 @                !         
   470	    88	       )  "  p      1       :                     n    @              {    @A              €  "  p      1       ‘  ¡  @@      €       ”  "  Î             «     @              ·  "  6      :       Ä  !  x=             Ï  "  Ü             æ  "  r      (       ô          Z           º      @                             6    x             Y  "  à      V       r                        !                Œ                      ¦  ¡  À@      €       ­  !  "              ·    &              FluxEtape.cpp main.cpp _ZZ4mainENKUlvE_clEv _ZZ4mainENUlvE_4_FUNEv _ZZ4mainENKUlvE0_clEv _ZZ4mainENUlvE0_4_FUNEv _ZZ4mainENKUlvE1_clEv _ZZ4mainENUlvE1_4_FUNEv mode.cpp __GNU_EH_FRAME_HDR _DYNAMIC _GLOBAL_OFFSET_TABLE_ _ZTI4Mode printf@GLIBC_2.2.5 _ZN5Etape8enteringEv _ZN9FluxEtapeC2Ev _ZN16ModeStateManager7shootHKEv _edata _ZN9FluxEtape8addEtapeEP5Etape _IO_stdin_used _ZN16ModeStateManagerC1EPP4Modei _ZN16ModeStateManager14hasModeChangedEv _ZTV8TestMode _ZN5EtapeC2EiPFvvES1_S1_ __cxa_finalize@GLIBC_2.2.5 _ZN5Etape7leavingEv main _ZN4Mode7leavingEi _ZN5Etape3runEv __dso_handle _ZN5Etape7routineEv _ZN4ModeC1Ei _ZTVN10__cxxabiv117__class_type_infoE@CXXABI_1.3 _fini __libc_start_main@GLIBC_2.34 _Z10read_paramh _ZN9FluxEtapeixEi _ZN4Mode8enteringEv _ZN16ModeStateManager3runEv _ZTV4Mode _ZTI8TestMode _ZN9FluxEtape3runEv _ZN9FluxEtape8getEtapeEv _ZN9FluxEtape9nextEtapeEv _ZN16ModeStateManagerC2EPP4Modei _ZN8TestMode7routineEv _ZN4Mode7shootHKEv _ZN8TestMode8enteringEv __stack_chk_fail@GLIBC_2.4 _init _Z11write_paramti _ZTV5Etape __TMC_END__ _ZTS8TestMode _ZN8TestModeC2Ei _ZTVN10__cxxabiv120__si_class_type_infoE@CXXABI_1.3 __data_start _end _ZN8TestModeC1Ei HK _ZN8TestMode7leavingEi __bss_start _ZN4ModeC2Ei _ZTI5Etape _ZN8TestMode7shootHKEv _Z8write_HKti _ZN5Etape7shootHKEv _ZN9FluxEtapeC1Ev _ITM_deregisterTMCloneTable _ZN9FluxEtape11removeEtapeEP5Etape _ZN5EtapeC1EiPFvvES1_S1_ __gmon_start__ _ZTS5Etape _ITM_registerTMCloneTable params _ZTS4Mode _ZN4Mode7routineEv  .symtab .strtab .shstrtab .note.gnu.property .note.gnu.build-id .interp .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .text .fini .rodata .eh_frame_hdr .eh_frame .note.ABI-tag .init_array .fini_array .data.rel.ro .dynamic .got .got.plt .data .bss .comment .debug_aranges .debug_info .debug_abbrev .debug_line .debug_str .debug_line_str .debug_rnglists                                                                                 P      P      @                              .                         $                              A             ´      ´                                    I   öÿÿo       Ğ      Ğ                                   S             ğ      ğ      ğ                           [             à      à      +                             c   ÿÿÿo                                               p   şÿÿo                     `                                         €      €      ˆ                           ‰      B       	      	      0                           “                                                                                    0                             ™             P      P      l	                             Ÿ             ¼      ¼                                    ¥                             (                              ­             (       (       D                             »             p!      p!      ø                             Å             h&      h&                                     Ó             ğ<      ğ,                                   ß             ø<      ø,                                   ë              =       -      °                              ø             °=      °-                                             À?      À/      (                                         è?      è/      (                                         @      0                                                 @       0                                          0                0                                   #                     ;0      €                             2                     »1      ¼                              >                     wR      Û	                             L                     R\      ú                             X     0               Lb      F                            c     0               ’i      z                            s                     k      À                                                    Ğk      °      $                    	                      €s      Ê                                                   Jy      ƒ                             
FluxEtape.cpp
     1	#include "FluxEtape.hpp"
     2	#include <cstddef>
     3	
     4	FluxEtape::FluxEtape() {
     5	    size = 0;
     6	    currentEtape = 0;
     7	    isNextEtape = false;
     8	
     9	    root = NULL;
    10	    current = NULL;
    11	}
    12	
    13	Etape*
    14	FluxEtape::operator[] (int n)
    15	{
    16	    Etape* it = root;
    17	    for (int i = 0; it != NULL && i < n; i++)
    18	        it = it->next;
    19	
    20	    return it;
    21	}
    22	
    23	int  
    24	FluxEtape::getEtape()
    25	{
    26	    return currentEtape;
    27	}
    28	
    29	int 
    30	FluxEtape::nextEtape()
    31	{
    32	    if (isNextEtape == false)
    33	        return 0;
    34	
    35	    if (current->next == NULL)
    36	        return -1;
    37	
    38	    current = current->next;
    39	    currentEtape += 1;
    40	
    41	    return 1;
    42	}
    43	
    44	int
    45	FluxEtape::addEtape(Etape* e)
    46	{
    47	    if (root == NULL) {
    48	        root = e;
    49	        return 1;
    50	    }
    51	
    52	    Etape* last = (*this)[size > 0 ? size - 1 : 0];
    53	    last->next = e;
    54	    last = last->next;
    55	    size += 1;
    56	    return 1;
    57	}
    58	
    59	void
    60	FluxEtape::run()
    61	{
    62	    while (currentEtape < size) {
    63	        current->run();
    64	        nextEtape();
    65	    }
    66	}
    67	
    68	void 
    69	FluxEtape::removeEtape (Etape* e)
    70	{
    71	    // NOT NECESSARY
    72	}
FluxEtape.hpp
     1	#ifndef FLUXETAPE
     2	#define FLUXETAPE
     3	
     4	#include "Etape.hpp"
     5	
     6	class FluxEtape 
     7	{
     8	protected:
     9	    int size;
    10	    int currentEtape;
    11	    bool isNextEtape;
    12	    Etape* root;
    13	    Etape* current;
    14	
    15	public:
    16	    Etape* operator[] (int n);
    17	    FluxEtape();
    18	
    19	    int getEtape();
    20	    int nextEtape();
    21	
    22	    int addEtape (Etape*);
    23	    void removeEtape (Etape*);
    24	
    25	    void run();
    26	};
    27	
    28	#endif
LibSpikCU_slave.h
     1	#ifndef LIBSPIKCU_SLAVE_H
     2	#define LIBSPIKCU_SLAVE_H
     3	#include <cstdint>
     4	
     5	inline uint16_t HK[64] = {0};
     6	inline uint16_t params[64] = {0};
     7	
     8	// Inline the functions
     9	inline void write_HK(uint16_t value, int index) {
    10	    HK[index] = value;
    11	}
    12	
    13	inline void write_param(uint16_t value, int index) {
    14	    params[index] = value;
    15	}
    16	
    17	inline uint16_t read_param(uint8_t reg_offset) {
    18	    return params[reg_offset];
    19	}
    20	#endif
main.cpp
     1	#include "mode.hpp"
     2	#include <stdio.h>
     3	
     4	class TestMode: public Mode {
     5	
     6	public:
     7	    TestMode(int mode) : Mode(mode) {  };
     8	
     9	    void 
    10	    entering() override
    11	    {
    12	
    13	    }
    14	
    15	    void 
    16	    routine() override
    17	    {
    18	        flux.run();
    19	    }
    20	
    21	    void 
    22	    leaving(int nextMode) override
    23	    {
    24	
    25	    }
    26	
    27	    void 
    28	    shootHK() override 
    29	    {
    30	        Mode::shootHK();
    31	    }
    32	};
    33	
    34	int
    35	main()
    36	{
    37	    TestMode test(0);
    38	
    39	    void (*enter)() = []() {
    40	        printf("entering...");
    41	    };
    42	
    43	    void (*routine)() = []() {
    44	        printf("entering...");
    45	    };
    46	
    47	    void (*leave)() = []() {
    48	        printf("entering...");
    49	    };
    50	
    51	    Etape _001(0, enter, routine, leave);
    52	
    53	    test.flux.addEtape(&_001);
    54	
    55	    test.entering();
    56	    test.routine();
    57	}
mode.cpp
     1	#include "mode.hpp"
     2	
     3	void Mode::entering()
     4	{
     5	    // write_param(MODE, this->modeId);
     6	}
     7	
     8	void Mode::leaving(int nextMode)
     9	{
    10	    write_param(MODE, nextMode);
    11	}
    12	
    13	void Mode::routine()
    14	{
    15	    // Do nothing
    16	}
    17	
    18	void Mode::shootHK()
    19	{
    20	    write_HK(read_param(CTRL_uC), 0);
    21	    write_HK(read_param(MODE), 1);
    22	    write_HK(read_param(TIME_CCSDS_100MS), 4);
    23	}
    24	
    25	ModeStateManager::ModeStateManager(Mode **modes, int modeCount)
    26	{
    27	    this->modes = modes;
    28	    this->modeCount = modeCount;
    29	    this->currentMode = 0;
    30	}
    31	
    32	void ModeStateManager::run()
    33	{
    34	    while (1)
    35	    {
    36	        write_param(MODE, currentMode);
    37	        modes[currentMode]->entering();
    38	        while (!hasModeChanged())
    39	        {
    40	            modes[currentMode]->routine();
    41	        }
    42	        modes[currentMode]->leaving(nextMode);
    43	        currentMode = nextMode;
    44	    }
    45	}
    46	
    47	/**
    48	 * @brief Check if the mode has changed
    49	 * @return true if the mode has changed
    50	 */
    51	bool ModeStateManager::hasModeChanged()
    52	{
    53	    // Two Possible ways of changing mode either by reading the
    54	    // nextMode from the OBC or by checking the currentMode
    55	
    56	    // The Payload has changed the mode (i.e END or ERROR )
    57	    if (nextMode != currentMode)
    58	    {
    59	        write_param(MODE_SUIVANT, nextMode);
    60	        return true;
    61	    }
    62	    // Check if the OBC has changed the mode
    63	    nextMode = read_param(MODE_SUIVANT);
    64	    return nextMode != currentMode;
    65	}
    66	
    67	void ModeStateManager::shootHK()
    68	{
    69	    modes[currentMode]->shootHK();
    70	}
mode.hpp
     1	#ifndef MODEDEF
     2	#define MODEDEF
     3	
     4	#include "FluxEtape.hpp"
     5	
     6	class Mode
     7	{
     8	protected:
     9	    int modeId;
    10	
    11	public:
    12	    Mode(int modeId) : modeId(modeId) {}
    13	    FluxEtape flux;
    14	    virtual void entering();
    15	    virtual void routine();
    16	    virtual void leaving(int nextMode);
    17	    virtual void shootHK();
    18	};
    19	
    20	class ModeStateManager
    21	{
    22	private:
    23	    Mode **modes;
    24	    int currentMode = 0;
    25	    int modeCount;
    26	    int nextMode;
    27	
    28	public:
    29	    ModeStateManager(Mode **modes, int modeCount);
    30	    void run();
    31	    bool hasModeChanged();
    32	    void shootHK();
    33	};
    34	;
    35	
    36	#endif
